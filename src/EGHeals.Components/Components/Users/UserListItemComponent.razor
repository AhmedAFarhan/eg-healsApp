@using EGHeals.Models.Dtos.Users
@using EGHeals.Models.Dtos.Users.Responses
@inject NavigationManager NavigationManager

<GridCardUI OnFirstAction="@OnToggleActivationHandler" FirstActionText="Activate">
    <PopupActions>
        <GridCardContextPopupActionUI Text="Permissions" Icon="fa-regular fa-universal-access" OnClick="@OnShowPermissionsHandler" />
        <GridCardContextPopupActionUI Text="Edit" Icon="fa-regular fa-universal-access" OnClick="@OnEditUserHandler" />
        <GridCardContextPopupActionUI Text="Delete" Icon="fa-regular fa-universal-access" OnClick="@OnDeleteUserHandler" />
    </PopupActions>
    <ChildContent>
        <div class="user">
            <CardActivationFlipperUI IsFlipped="@isFlipped">
                <Icon Context="p">
                    <ReceptionistIcon ContainerClass="@p.ContainerClass" PathClass="@p.PathClass" />
                </Icon>
            </CardActivationFlipperUI>
            <div class="user__username">@User.Username</div>
            <div class="user__roles-container">
                <div class="user__role-title">Roles : </div>
                <ul class="user__roles">
                    @foreach (var role in User.UserRoles)
                    {
                        <li class="user__role">@role.RoleName</li>
                    }
                </ul>
            </div>
        </div>
    </ChildContent>
</GridCardUI>

@code{

    private bool isFlipped = false;

    [Parameter] public bool InInit { get; set; } = false;

    [Parameter] public SubUserResponseDto User { get; set; } = default!;

    private void OnEditUserHandler()
    {

    }

    private void OnDeleteUserHandler()
    {

    }

    private void OnShowPermissionsHandler()
    {
        NavigationManager.NavigateTo($"/user-roles/{User.Id}");
    }

    private void OnToggleActivationHandler()
    {
        isFlipped = !isFlipped;
    }

}